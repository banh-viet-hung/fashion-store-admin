import{r as k,S as q,i as z,j as e,f as t}from"./index-PLDaagTA.js";import{u as G,n as K}from"./Layout-XD39IB8x.js";import{e as E}from"./exportFromJSON-fDIoOtpr.js";import{n as W}from"./toast-DhrUUM-V.js";import{u as X}from"./useAsync-frAQ4t-E.js";import{u as Y}from"./useFilter-BFXugzkf.js";import{O as L}from"./OrderServices-DicPIjoy.js";import{N as Z}from"./NotFound-Z5WVCT-B.js";import{P as ee}from"./PageTitle-DoOTr-E6.js";import{O as te}from"./OrderTable-7-xWQMw5.js";import{T as se}from"./TableLoading-BIzq2BWk.js";import{s as le}from"./spinner-CkndCogW.js";import{A as ae}from"./AnimatedContent-BfEynzY3.js";import"./iconBase-DFE9nSFk.js";import"./browser-BYFnD1zY.js";import"./index-CP4Dvlba.js";import"./useDisableForDemo-DjtHBIR8.js";import"./ProductServices-Cz4MygcK.js";import"./CouponServices-0CD9yxjP.js";import"./CurrencyServices-BlJ4lGlV.js";import"./Tooltip-DmGlEDOP.js";import"./index-Ck7-pvvx.js";import"./SelectStatus-BM1yTAHo.js";const Se=()=>{var O,D,S,P;const{time:m,setTime:x,status:g,endDate:u,setStatus:p,setEndDate:j,startDate:b,currentPage:I,searchText:f,searchRef:v,method:y,setMethod:T,setStartDate:C,setSearchText:B,handleChangePage:M,handleSubmitForAll:R,resultsPerPage:N}=k.useContext(q),{t:s}=z(),[d,c]=k.useState(!1),{data:l,loading:_,error:w}=X(()=>L.getAllOrders({day:m,method:y,status:g,page:I,endDate:u,startDate:b,limit:N,customerName:f})),{currency:V,getNumber:H,getNumberTwo:i}=G(),{dataTable:J,serviceData:h}=Y(l==null?void 0:l.orders),Q=async()=>{var a,o,A;try{c(!0);const n=await L.getAllOrders({page:1,day:m,method:y,status:g,endDate:u,download:!0,startDate:b,limit:l==null?void 0:l.totalDoc,customerName:f}),$=(a=n==null?void 0:n.orders)==null?void 0:a.map(r=>{var F;return{_id:r._id,invoice:r.invoice,subTotal:i(r.subTotal),shippingCost:i(r.shippingCost),discount:i(r==null?void 0:r.discount),total:i(r.total),paymentMethod:r.paymentMethod,status:r.status,user_info:(F=r==null?void 0:r.user_info)==null?void 0:F.name,createdAt:r.createdAt,updatedAt:r.updatedAt}});E({data:$,fileName:"orders",exportType:E.types.csv}),c(!1)}catch(n){c(!1),W(((A=(o=n==null?void 0:n.response)==null?void 0:o.data)==null?void 0:A.message)||(n==null?void 0:n.message))}},U=()=>{x(""),T(""),p(""),j(""),C(""),B(""),v.current.value=""};return e.jsxs(e.Fragment,{children:[e.jsx(ee,{children:s("Quản lý đơn hàng")}),e.jsx(ae,{children:e.jsx(t.Card,{className:"min-w-0 shadow-xs overflow-hidden bg-white dark:bg-gray-800 mb-5",children:e.jsx(t.CardBody,{children:e.jsxs("form",{onSubmit:R,children:[e.jsxs("div",{className:"grid gap-4 lg:gap-4 xl:gap-6 md:gap-2 md:grid-cols-5 py-2",children:[e.jsx("div",{children:e.jsx(t.Input,{ref:v,type:"search",name:"search",placeholder:"Nhập mã đơn hàng"})}),e.jsx("div",{children:e.jsxs(t.Select,{onChange:a=>p(a.target.value),children:[e.jsx("option",{value:"Status",defaultValue:!0,hidden:!0,children:s("Trạng thái đơn hàng")}),e.jsx("option",{value:"Delivered",children:s("PageOrderDelivered")}),e.jsx("option",{value:"Pending",children:s("PageOrderPending")}),e.jsx("option",{value:"Processing",children:s("PageOrderProcessing")}),e.jsx("option",{value:"Cancel",children:s("OrderCancel")})]})}),e.jsx("div",{children:e.jsxs(t.Select,{onChange:a=>x(a.target.value),children:[e.jsx("option",{value:"Order limits",defaultValue:!0,hidden:!0,children:s("Đặt hàng gần đây")}),e.jsx("option",{value:"5",children:s("DaysOrders5")}),e.jsx("option",{value:"7",children:s("DaysOrders7")}),e.jsx("option",{value:"15",children:s("DaysOrders15")}),e.jsx("option",{value:"30",children:s("DaysOrders30")})]})}),e.jsx("div",{children:e.jsxs(t.Select,{onChange:a=>T(a.target.value),children:[e.jsx("option",{value:"Method",defaultValue:!0,hidden:!0,children:s("Phương thức thanh toán")}),e.jsx("option",{value:"Cash",children:s("Cash")}),e.jsx("option",{value:"Card",children:s("Card")}),e.jsx("option",{value:"Credit",children:s("Credit")})]})}),e.jsx("div",{children:d?e.jsxs(t.Button,{disabled:!0,type:"button",className:"h-12 w-full",children:[e.jsx("img",{src:le,alt:"Loading",width:20,height:10})," ",e.jsx("span",{className:"font-serif ml-2 font-light",children:"Processing"})]}):e.jsxs("button",{onClick:Q,disabled:((O=l==null?void 0:l.orders)==null?void 0:O.length)<=0||d,type:"button",className:`${(((D=l==null?void 0:l.orders)==null?void 0:D.length)<=0||d)&&"opacity-50 cursor-not-allowed bg-emerald-600"} flex items-center justify-center text-sm leading-5 h-12 w-full text-center transition-colors duration-150 font-medium px-6 py-2 rounded-md text-white bg-emerald-500 border border-transparent active:bg-emerald-600 hover:bg-emerald-600 `,children:["Tải xuống tất cả",e.jsx("span",{className:"ml-2 text-base",children:e.jsx(K,{})})]})})]}),e.jsxs("div",{className:"grid gap-4 lg:gap-6 xl:gap-6 lg:grid-cols-3 xl:grid-cols-3 md:grid-cols-3 sm:grid-cols-1 py-2",children:[e.jsxs("div",{children:[e.jsx(t.Label,{children:"Start Date"}),e.jsx(t.Input,{type:"date",name:"startDate",onChange:a=>C(a.target.value)})]}),e.jsxs("div",{children:[e.jsx(t.Label,{children:"End Date"}),e.jsx(t.Input,{type:"date",name:"startDate",onChange:a=>j(a.target.value)})]}),e.jsxs("div",{className:"mt-2 md:mt-0 flex items-center xl:gap-x-4 gap-x-1 flex-grow-0 md:flex-grow lg:flex-grow xl:flex-grow",children:[e.jsxs("div",{className:"w-full mx-1",children:[e.jsx(t.Label,{style:{visibility:"hidden"},children:"Filter"}),e.jsx(t.Button,{type:"submit",className:"h-12 w-full bg-emerald-700",children:"Áp dụng"})]}),e.jsxs("div",{className:"w-full",children:[e.jsx(t.Label,{style:{visibility:"hidden"},children:"Reset"}),e.jsx(t.Button,{layout:"outline",onClick:U,type:"reset",className:"px-4 md:py-1 py-3 text-sm dark:bg-gray-700",children:e.jsx("span",{className:"text-black dark:text-gray-200",children:"Hoàn tác"})})]})]})]})]})})})}),((S=l==null?void 0:l.methodTotals)==null?void 0:S.length)>0&&e.jsx(t.Card,{className:"min-w-0 shadow-xs overflow-hidden bg-white dark:bg-gray-800 rounded-t-lg rounded-0 mb-4",children:e.jsx(t.CardBody,{children:e.jsx("div",{className:"flex gap-1",children:(P=l==null?void 0:l.methodTotals)==null?void 0:P.map((a,o)=>e.jsx("div",{className:"dark:text-gray-300",children:(a==null?void 0:a.method)&&e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"font-medium",children:[" ",a.method]})," :"," ",e.jsxs("span",{className:"font-semibold mr-2",children:[V,H(a.total)]})]})},o+1))})})}),_?e.jsx(se,{row:12,col:7,width:160,height:20}):w?e.jsx("span",{className:"text-center mx-auto text-red-500",children:w}):(h==null?void 0:h.length)!==0?e.jsxs(t.TableContainer,{className:"mb-8 dark:bg-gray-900",children:[e.jsxs(t.Table,{children:[e.jsx(t.TableHeader,{children:e.jsxs("tr",{children:[e.jsx(t.TableCell,{children:s("InvoiceNo")}),e.jsx(t.TableCell,{children:s("TimeTbl")}),e.jsx(t.TableCell,{children:s("CustomerName")}),e.jsx(t.TableCell,{children:s("MethodTbl")}),e.jsx(t.TableCell,{children:s("AmountTbl")}),e.jsx(t.TableCell,{children:s("OderStatusTbl")}),e.jsx(t.TableCell,{children:s("ActionTbl")}),e.jsx(t.TableCell,{className:"text-right",children:s("InvoiceTbl")})]})}),e.jsx(te,{orders:J})]}),e.jsx(t.TableFooter,{children:e.jsx(t.Pagination,{totalResults:l==null?void 0:l.totalDoc,resultsPerPage:N,onChange:M,label:"Table navigation"})})]}):e.jsx(Z,{title:"Sorry, There are no orders right now."})]})};export{Se as default};
