import{r as g,A as L,q as N,u as E,h as p}from"./index-PLDaagTA.js";import{u as O}from"./index.esm-CS4zo5jb.js";import{A as t}from"./AdminServices-DOFZR09-.js";import{n as a,a as d}from"./toast-DhrUUM-V.js";const q=()=>{const[l,o]=g.useState(!1),{dispatch:n}=g.useContext(L),i=N(),s=E(),{register:y,handleSubmit:S,formState:{errors:h}}=O();return{onSubmit:async({name:x,email:r,verifyEmail:b,password:c,role:A})=>{var u,f;o(!0);const m=1/24;try{if(s.pathname==="/login"){const e=await t.loginAdmin({email:r,password:c,rememberMe:!1});if(console.log("Phản hồi sau khi login",e),e&&e.success){if(e.data.role==="USER"){a("Bạn không có quyền truy cập trang này!");return}n({type:"USER_LOGIN",payload:e.data}),p.set("adminInfo",JSON.stringify(e.data),{expires:m,sameSite:"None",secure:!0}),i.replace("/dashboard")}else a(e.message||"Lỗi không xác định!")}if(s.pathname==="/signup"){const e=await t.registerAdmin({name:x,email:r,password:c,role:A});e&&(d("Register Success!"),n({type:"USER_LOGIN",payload:e}),p.set("adminInfo",JSON.stringify(e),{expires:m,sameSite:"None",secure:!0}),i.replace("/"))}if(s.pathname==="/forgot-password"){const e=await t.forgetPassword({verifyEmail:b});d(e.message)}}catch(e){a(((f=(u=e==null?void 0:e.response)==null?void 0:u.data)==null?void 0:f.message)||(e==null?void 0:e.message))}finally{o(!1)}},register:y,handleSubmit:S,errors:h,loading:l}};export{q as u};
