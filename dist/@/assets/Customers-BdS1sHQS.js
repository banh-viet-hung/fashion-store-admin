import{r as m,S as k,j as e,t as g,f as s,k as U,i as D}from"./index-PLDaagTA.js";import{S as F,d as A,i as L}from"./Layout-XD39IB8x.js";import{T as B,D as O,u as R,M as H}from"./DrawerButton-DwQOXQlS.js";import{D as Y}from"./DeleteModal-BuBHmZHf.js";import{T as v}from"./Tooltip-DmGlEDOP.js";import{u as $,E as N}from"./index.esm-CS4zo5jb.js";import{I as w}from"./InputArea-iBDtlSiU.js";import{L as C}from"./LabelArea-DC4hSjvs.js";import{a as T}from"./ProductServices-Cz4MygcK.js";import{n as S,a as M}from"./toast-DhrUUM-V.js";import{M as q,a as z,U as V}from"./UserStatusServices-CyrzkJQt.js";import{s as X}from"./spinner-CkndCogW.js";import{T as Q}from"./TableLoading-BIzq2BWk.js";import{N as Z}from"./NotFound-Z5WVCT-B.js";import{P as G}from"./PageTitle-DoOTr-E6.js";import{u as J}from"./useAsync-frAQ4t-E.js";import{A as K}from"./AnimatedContent-BfEynzY3.js";import"./iconBase-DFE9nSFk.js";import"./SelectLanguageTwo-B8pttvxA.js";import"./AdminServices-DOFZR09-.js";import"./CouponServices-0CD9yxjP.js";import"./CurrencyServices-BlJ4lGlV.js";import"./useDisableForDemo-DjtHBIR8.js";const W=a=>{const[o,i]=m.useState(""),[p,n]=m.useState(!1),{closeDrawer:t,setIsUpdate:x}=m.useContext(k),{register:y,handleSubmit:c,setValue:h,formState:{errors:u}}=$(),f=async l=>{var j,r;try{n(!0);const d={name:l.name,email:l.email,phone:l.phone,address:l.address};if(a){const b=await T.updateCustomer(a,d);x(!0),M(b.message),t()}n(!1)}catch(d){S(((r=(j=d==null?void 0:d.response)==null?void 0:j.data)==null?void 0:r.message)||(d==null?void 0:d.message)),t()}};return m.useEffect(()=>{a&&(async()=>{var l,j;try{const r=await T.getCustomerById(a);r&&(h("name",r.name),h("phone",r.phone),h("email",r.email),h("address",r.address))}catch(r){S(((j=(l=r==null?void 0:r.response)==null?void 0:l.data)==null?void 0:j.message)||(r==null?void 0:r.message))}})()},[a,h]),{register:y,handleSubmit:c,onSubmit:f,errors:u,setImageUrl:i,imageUrl:o,isSubmitting:p}},_=({id:a})=>{const{register:o,handleSubmit:i,onSubmit:p,errors:n,isSubmitting:t}=W(a);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-full relative p-6 border-b border-gray-100 bg-gray-50 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-300",children:a?e.jsx(B,{title:"Update Customer",description:"Update your Customer necessary information from here"}):e.jsx(B,{title:"Add Customer",description:"Add your Customer necessary information from here"})}),e.jsx(F,{className:"w-full md:w-7/12 lg:w-8/12 xl:w-8/12 relative dark:bg-gray-700 dark:text-gray-200",children:e.jsxs("form",{onSubmit:i(p),children:[e.jsxs("div",{className:"px-6 pt-8 flex-grow scrollbar-hide w-full max-h-full pb-40",children:[e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(C,{label:"Name"}),e.jsxs("div",{className:"col-span-8 sm:col-span-4",children:[e.jsx(w,{required:!0,register:o,label:"Name",name:"name",type:"text",placeholder:"Name"}),e.jsx(N,{errorName:n.name})]})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(C,{label:"Email"}),e.jsxs("div",{className:"col-span-8 sm:col-span-4",children:[e.jsx(w,{required:!0,register:o,label:"Email",name:"email",type:"email",placeholder:"Email"}),e.jsx(N,{errorName:n.email})]})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(C,{label:"Phone"}),e.jsxs("div",{className:"col-span-8 sm:col-span-4",children:[e.jsx(w,{register:o,label:"Phone",name:"phone",type:"text",placeholder:"Phone"}),e.jsx(N,{errorName:n.phone})]})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(C,{label:"Address"}),e.jsxs("div",{className:"col-span-8 sm:col-span-4",children:[e.jsx(w,{register:o,label:"Address",name:"address",type:"text",placeholder:"Address"}),e.jsx(N,{errorName:n.address})]})]})]}),e.jsx(O,{id:a,title:"Customer",isSubmitting:t})]})})]})},ee=({email:a,isActive:o})=>{const{setIsUpdate:i}=m.useContext(k),[p,n]=m.useState(!1),[t,x]=m.useState(!1),y=()=>{x(!0)},c=()=>{x(!1)},h=async()=>{var u,f;try{n(!0);const l=await V.changeUserStatus(a);i(!0),M(l.message||"Trạng thái tài khoản đã được thay đổi!"),n(!1),c()}catch(l){S(((f=(u=l==null?void 0:l.response)==null?void 0:u.data)==null?void 0:f.message)||(l==null?void 0:l.message)),n(!1),c()}};return e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:y,className:"p-2 cursor-pointer text-gray-400 hover:text-yellow-600 focus:outline-none",children:o?e.jsx(v,{id:"block",Icon:q,title:g("Block"),bgColor:"#EF4444"}):e.jsx(v,{id:"unlock",Icon:z,title:g("Unlock"),bgColor:"#10B981"})}),e.jsxs(s.Modal,{isOpen:t,onClose:c,children:[e.jsx(s.ModalBody,{className:"text-center custom-modal px-8 pt-6 pb-4",children:e.jsxs("h2",{className:"text-xl font-medium mb-2",children:[o?g("Bạn muốn khóa tài khoản"):g("Bạn muốn mở khóa tài khoản")," ",e.jsx("span",{className:"text-blue-500",children:a}),"?"]})}),e.jsxs(s.ModalFooter,{className:"justify-center",children:[e.jsx(s.Button,{className:"w-full sm:w-auto hover:bg-white hover:border-gray-50",layout:"outline",onClick:c,children:g("Hủy thao tác")}),e.jsx("div",{className:"flex justify-end",children:p?e.jsxs(s.Button,{disabled:!0,type:"button",className:"w-full h-12 sm:w-auto",children:[e.jsx("img",{src:X,alt:"Loading",width:20,height:10})," ",e.jsx("span",{className:"font-serif ml-2 font-light",children:g("Processing")})]}):e.jsx(s.Button,{onClick:h,className:`w-full h-12 sm:w-auto ${o?"bg-red-500 hover:bg-red-600":"bg-emerald-500 hover:bg-emerald-600"}`,children:o?g("Xác nhận khóa"):g("Xác nhận mở khóa")})})]})]})]})},se=({customers:a})=>{const{title:o,serviceId:i,handleModalOpen:p,handleUpdate:n}=R();return e.jsxs(e.Fragment,{children:[e.jsx(Y,{id:i,title:o}),e.jsx(H,{children:e.jsx(_,{id:i})}),e.jsx(s.TableBody,{children:a==null?void 0:a.map(t=>e.jsxs(s.TableRow,{children:[e.jsx(s.TableCell,{children:e.jsx("span",{className:`px-2 py-1 rounded text-xs ${t.active?"bg-green-500 text-white":"bg-red-500 text-white"}`,children:t.active?"Active":"Blocked"})}),e.jsx(s.TableCell,{children:e.jsx("span",{className:"text-sm",children:t.dateOfBirth?A(t.dateOfBirth).format("MMM D, YYYY"):"Chưa cập nhật"})}),e.jsx(s.TableCell,{children:e.jsx("span",{className:"text-sm",children:t.fullName})}),e.jsx(s.TableCell,{children:e.jsx("span",{className:"text-sm",children:t.email})}),e.jsx(s.TableCell,{children:e.jsx("span",{className:"text-sm font-medium",children:t.phoneNumber||"Chưa cập nhật"})}),e.jsx(s.TableCell,{children:e.jsxs("div",{className:"flex justify-end text-right",children:[e.jsx("div",{className:"p-2 cursor-pointer text-gray-400 hover:text-emerald-600",children:e.jsx(U,{to:`/customer-order/${t.id}`,children:e.jsx(v,{id:"view",Icon:L,title:g("ViewOrder"),bgColor:"#34D399"})})}),e.jsx(ee,{email:t.email,isActive:t.active})]})})]},t.id))})]})},Te=()=>{var r,d;const{t:a}=D(),{currentPage:o,setCurrentPage:i,searchText:p,setSearchText:n,resultsPerPage:t}=m.useContext(k),x=m.useRef(null),y=async({cancelToken:b})=>{const I=o,E=5,P=p||"";return T.getAllCustomers({page:I,size:E,email:P,cancelToken:b})},{data:c,loading:h,error:u}=J(y);m.useEffect(()=>{n(""),i(1)},[n,i]);const f=b=>{b.preventDefault(),n(x.current.value),i(1)},l=()=>{n(""),i(1),x.current&&(x.current.value="")},j=b=>{i(b)};return e.jsxs(e.Fragment,{children:[e.jsx(G,{children:a("Quản lý khách hàng")}),e.jsx(K,{children:e.jsx(s.Card,{className:"min-w-0 shadow-xs overflow-hidden bg-white dark:bg-gray-800 mb-5",children:e.jsx(s.CardBody,{children:e.jsxs("form",{onSubmit:f,className:"py-3 grid gap-4 lg:gap-6 xl:gap-6 md:flex xl:flex",children:[e.jsx("div",{className:"flex-grow-0 md:flex-grow lg:flex-grow xl:flex-grow",children:e.jsx(s.Input,{ref:x,type:"search",name:"search",placeholder:a("Nhập email khách hàng")})}),e.jsxs("div",{className:"flex items-center gap-2 flex-grow-0 md:flex-grow lg:flex-grow xl:flex-grow",children:[e.jsx("div",{className:"w-full mx-1",children:e.jsx(s.Button,{type:"submit",className:"h-12 w-full bg-emerald-700",children:"Áp dụng"})}),e.jsx("div",{className:"w-full mx-1",children:e.jsx(s.Button,{layout:"outline",onClick:l,type:"reset",className:"px-4 md:py-1 py-2 h-12 text-sm dark:bg-gray-700",children:e.jsx("span",{className:"text-black dark:text-gray-200",children:"Hoàn tác"})})})]})]})})})}),h?e.jsx(Q,{row:12,col:6,width:190,height:20}):u?e.jsx("span",{className:"text-center mx-auto text-red-500",children:u}):((d=(r=c==null?void 0:c.data)==null?void 0:r.content)==null?void 0:d.length)>0?e.jsxs(s.TableContainer,{className:"mb-8",children:[e.jsxs(s.Table,{children:[e.jsx(s.TableHeader,{children:e.jsxs("tr",{children:[e.jsx(s.TableCell,{children:a("Trạng thái")}),e.jsx(s.TableCell,{children:a("Ngày sinh")}),e.jsx(s.TableCell,{children:a("Họ tên")}),e.jsx(s.TableCell,{children:a("Email")}),e.jsx(s.TableCell,{children:a("SĐT")}),e.jsx(s.TableCell,{className:"text-right",children:a("Hành động")})]})}),e.jsx(se,{customers:c.data.content})]}),e.jsx(s.TableFooter,{children:e.jsx(s.Pagination,{totalResults:c.data.totalElements,resultsPerPage:c.data.size,onChange:j,label:"Table navigation"})})]}):e.jsx(Z,{title:"Sorry, There are no customers right now."})]})};export{Te as default};
